<?php
/**
 * @file
 * File description.
 *
 * Long description.
 */

/**
 * Implements hook_theme().
 */
function stanford_page_theme($existing, $type, $thing, $path) {

  // Tell Drupal About the Page Title Template.
  $theme['field__node__title__stanford_page'] = [
    'theme path' => drupal_get_path('module', 'stanford_page'),
    'path' => drupal_get_path('module', 'stanford_page') . "/templates",
    'base hook' => 'field__node__title',
  ];

  // Tell Drupal about the secondary sidebar menu.
  $theme['block__menu_block__secondary__sidebar__menu'] = [
    'theme path' => drupal_get_path('module', 'stanford_page'),
    'path' => drupal_get_path('module', 'stanford_page') . "/templates",
    'base hook' => 'block',
  ];

  // Tell Drupal about the caption field
  $theme['field__node__field_s_page_ft_img_cpt'] = [
    'theme path' => drupal_get_path('module', 'stanford_page'),
    'path' => drupal_get_path('module', 'stanford_page') . "/templates",
    'base hook' => 'field',
  ];

  // Tell Drupal about the menu
  $theme['menu__secondary__sidebar__menu'] = [
    'theme path' => drupal_get_path('module', 'stanford_page'),
    'path' => drupal_get_path('module', 'stanford_page') . "/templates",
    'base hook' => 'menu',
  ];

  return $theme;
}

/**
 * Attach some CSS to the page.
 * @param  [type] $vars [description]
 * @return [type]       [description]
 */
function stanford_page_preprocess_page(&$vars) {

  // Get the node from the route.
  $node = \Drupal::routeMatch()->getParameter('node');

  // Not a node.. Then just continue.
  if (!$node) {
    return;
  }

  // Check for our type and add library if a match.
  if ($node->getType() == "stanford_page") {
    $vars['#attached']['library'][] = "stanford_page/page";
  }

}
